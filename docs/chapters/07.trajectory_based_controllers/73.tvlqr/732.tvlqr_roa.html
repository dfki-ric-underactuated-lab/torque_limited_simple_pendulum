<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Region of Attraction (RoA) estimation &mdash; Torque-limited Simple Pendulum  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="iLQR Model Predictive Control" href="../74.ilqr.html" />
    <link rel="prev" title="Theory" href="731.tvlqr.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Torque-limited Simple Pendulum
              <img src="../../../_static/pendulum_light_painting.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../00.installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01.usage_instructions.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02.model.html">The Physics of a Simple Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03.simulation.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04.hardware.html">Hardware Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05.trajectory_optimization.html">Trajectory Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../06.reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../07.trajectory_based_controllers.html">Trajectory-based Controllers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../71.open_loop.html">Open Loop Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../72.pid.html">Proportional-Integral-Derivative (PID) Control</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../73.tvlqr.html">Time-varying Linear Quadratic Regulator (TVLQR)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html">Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html#api">API</a></li>
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html#comments">Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="731.tvlqr.html#references">References</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Region of Attraction (RoA) estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#probabilistic-method">Probabilistic method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sos-method">SOS method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../74.ilqr.html">iLQR Model Predictive Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../08.policy_based_controllers.html">Policy-based Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09.analysis.html">Controller Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11.contributing.html">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generated/simple_pendulum.html">Software Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Torque-limited Simple Pendulum</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../07.trajectory_based_controllers.html">Trajectory-based Controllers</a></li>
          <li class="breadcrumb-item"><a href="../73.tvlqr.html">Time-varying Linear Quadratic Regulator (TVLQR)</a></li>
      <li class="breadcrumb-item active">Region of Attraction (RoA) estimation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/chapters/07.trajectory_based_controllers/73.tvlqr/732.tvlqr_roa.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="region-of-attraction-roa-estimation">
<h1>Region of Attraction (RoA) estimation<a class="headerlink" href="#region-of-attraction-roa-estimation" title="Permalink to this heading"></a></h1>
<p>The region of attraction estimation is an offline process that can be applied to the closed-loop dynamics of a system (Plant and Controller) in order to analyze the control behaviour. The time-varying version of this analysis offers a very interesting point of view to understand how much the state can vary with respect to a nominal trajectory that brings a fixed initial state to a desired state. Hence, this process results in a very powerful tool to verify the robustness of a time-varying controller.</p>
<section id="probabilistic-method">
<h2>Probabilistic method<a class="headerlink" href="#probabilistic-method" title="Permalink to this heading"></a></h2>
<p>For simple systems, such as the torque limited simple pendulum under TVLQR control, the RoA can be estimated by a very intuitive simulation-based method.
The implemented solution takes inspiration from some related works that has been studied and extended.
E. Najafi proposed a computationally effective sampling approach to estimate the DoAs of nonlinear systems in real time:</p>
<blockquote>
<div><ol class="upperalpha simple" start="5">
<li><p>Najafi, R. Babuška, and G. A. D. Lopes, “A fast sampling method for estimating the domain of attraction,” Nonlinear Dyn, vol. 86, no. 2, pp. 823–834, Oct. 2016, doi: 10.1007/11071-016-2926-7.</p></li>
</ol>
</div></blockquote>
<p>He used this method for estimating a time-invariant region of attraction in two different ways: “memoryless sampling” and “sampling with memory”. We have exploited his results from the memoryless version by extending the study to the time-varying case.
This extension has been already somehow addressed by P. Reist which included it in a simulation-based variant of the LQR-Tree feedback-motion-planning approach:</p>
<blockquote>
<div><ol class="upperalpha simple" start="16">
<li><p>Reist, P. V. Preiswerk, and R. Tedrake, “Feedback-motion-planning with simulation-based lqr-trees”, SAGE, 2016, <a class="reference external" href="https://groups.csail.mit.edu/robotics-center/public_papers/Reist15.pdf">https://groups.csail.mit.edu/robotics-center/public_papers/Reist15.pdf</a>.</p></li>
</ol>
</div></blockquote>
<p>However, his implementation is strictly related to the LQR-Tree algorithm while we will focus on the region of attraction estimation.</p>
<section id="estimation-procedure">
<h3>Estimation procedure<a class="headerlink" href="#estimation-procedure" title="Permalink to this heading"></a></h3>
<p>First we have to fix the number of knot points N.
Except for the given last value, rho is  initially fixed to an N-dimensional array of infinity. The last value of rho comes from the time-invariant region of attraction estimation, while the other ones have to be fixed big enough to overcome its “real” value.
Now, after computing the nominal trajectory and the related TVLQR controller that bring to the goal the estimation process can start.
Iterating backward in the knot points, we can exploit the knowledge of the final rho from the time-invariant case. The “previous” and the “next” ellipse have been considered. We sample random initial states from the “previous” ellipse and we simulate them until the “next” one. In doing so, we can check if the simulated trajectory exits from the “next” ellipse. The condition is the following one:</p>
<div class="math notranslate nohighlight">
\[x^T S x &lt; \rho\]</div>
<p>If a simulated trajectory triggers this condition, the algorithm shrinks the “previous” ellipse using the value of the computed optimal cost to go:</p>
<div class="math notranslate nohighlight">
\[\rho_{new} = min ( \rho_{old} , ctg )\]</div>
<p>An implementation detail gives the possibility to reduce the time consumption. The estimation of each ellipse has been considered done after a maximum number of successful simulations.</p>
</section>
</section>
<section id="sos-method">
<h2>SOS method<a class="headerlink" href="#sos-method" title="Permalink to this heading"></a></h2>
<p>For the class of systems with polynomial dynamics f (x) , this problem can be formulated as a convex optimization problem using sums-of-squares (SOS) optimization. This different approach has very interesting advantages in terms of Scalability and it doesn’t need any Discretization in the time domain. Furthermore, it allows to reason about the RoA algebraically and does not require numerical simulations, that can be expensive.
On the other hand, it requires to express the closed-loop dynamics in a polynomial form. This might need some approximation, via Taylor series for examples, of the dynamics that can cause some difference between the simulation and the real behaviour.</p>
<p>My implementation of this estimation method is based on:</p>
<ul class="simple">
<li><p>Invariant Funnels around Trajectories using Sum-of-Squares Programming”, Mark M. Tobenkin, Ian R. Manchester, Russ Tedrake (<a class="reference external" href="https://doi.org/10.3182/20110828-6-IT-1002.03098">https://doi.org/10.3182/20110828-6-IT-1002.03098</a>)</p></li>
<li><p>Funnel libraries for real-time robust feedback motion planning”, Anirudha Majumdar, Russ Tedrake (<a class="reference external" href="https://doi.org/10.1177/0278364917712421">https://doi.org/10.1177/0278364917712421</a>)</p></li>
<li><p>Trajectory Optimization and Time-Varying LQR Stabilization of Airplane Longitudinal Dynamics” (<a class="reference external" href="https://github.com/benthomsen/mit-6832-project/blob/master/bthomsen-6832-report.pdf">https://github.com/benthomsen/mit-6832-project/blob/master/bthomsen-6832-report.pdf</a>)</p></li>
</ul>
<section id="id1">
<h3>Estimation procedure<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="../../../_images/optProblem.png"><img alt="Alternative text" src="../../../_images/optProblem.png" style="width: 400px;" /></a>
<p>This is the optimization problem that has to be solved in order to obtain the value of rho. The Lyapunov condition has been imposed by exploiting the so-called S-procedure. Unfortunately, this formulation is not convex in rho, so that it has to be solved with a bilinear alternation by fixing at each step the Lagrangian multiplier or rho.</p>
<p>Furthermore, it is worthwhile to mention the consequences of considering the input saturation constraint. It can be addressed by using some Lagrangian multipliers. However, this can lead to add a number of SOS conditions that grows exponentially with the number of inputs. Hence, this has to be considered in systems where there is a big number of inputs.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="731.tvlqr.html" class="btn btn-neutral float-left" title="Theory" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../74.ilqr.html" class="btn btn-neutral float-right" title="iLQR Model Predictive Control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>